# ğŸƒ Java Stream Performance Test

## âŒ Java Streamì—ì„œ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ 7ê°€ì§€
1. collect(), forEach(), reduce() ë“±ê³¼ ê°™ì€ Terminal Operationì„ ì“°ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆë‹¤.
2. ë°ì´í„° êµ¬ì¡°ë¥¼ ë°”ê¿€ ë•Œ ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ë„ ìˆë‹¤.
3. ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ í•­ìƒ ì„±ëŠ¥ í–¥ìƒì— ì¢‹ì€ ê²ƒì€ ì•„ë‹ˆë‹¤. (ì‘ì€ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì„±ëŠ¥ì„ ë–¨ì–´ëœ¨ë¦´ ìˆ˜ë„ ìˆë‹¤.)
4. filter()ë‚˜ map() ê°™ì€ ì¤‘ê°„ ì—°ì‚°ìë“¤ì„ ë„ˆë¬´ ë§ì´ ì£¼ë ì£¼ë  ì—°ê²°í•˜ë©´ ì„±ëŠ¥ ì €í•˜(ì˜¤ë²„í—¤ë“œ) ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
5. findFirst()ë‚˜ reduce() ê°™ì€ ì—°ì‚°ì€ ê²°ê³¼ë¡œ Optional ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ”ë°, ì´ë¥¼ ì œëŒ€ë¡œ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤
6. ë³‘ë ¬ ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•  ë•Œ ê³µìœ  ë³€ìˆ˜ë¥¼ ë™ì‹œì— ë°”ê¾¸ë©´ race conditionì´ ë°œìƒí•˜ê±°ë‚˜ ê²°ê³¼ê°’ì´ ë’¤ì£½ë°•ì£½ì´ ë  ìˆ˜ ìˆë‹¤.
7. ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ì„ ë¦¬í„´í•˜ëŠ” ì¤‘ê°„ ì—°ì‚°(Intermediate)ê³¼, ì‹¤ì œë¡œ ê²°ê³¼ë¥¼ ë„ì¶œí•´ ë‚´ëŠ” ìµœì¢… ì—°ì‚°(Terminal)ì˜ ì°¨ì´ë¥¼ í˜¼ë™í•˜ëŠ” ê²ƒì´ë‹¤.

## â‰ï¸ 7ê°€ì§€ê°€ ì™œ ë¬¸ì œê°€ ë ê¹Œ?
### 1ë²ˆ ì‹¤ìˆ˜: Terminal Operation ë¯¸ì‚¬ìš©
- **Terminal Operation ì´ë€?**
  > Streamì˜ ì‹¤í–‰ ë²„íŠ¼ìœ¼ë¡œ, ìµœì¢… ì—°ì‚°ì´ ì—†ë‹¤ë©´ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

- **Terminal Operationì˜ ì¢…ë¥˜**
    - **ê²°ê³¼ ì¶œë ¥ ë° ìˆ˜í–‰**
        - forEach(action): ìš”ì†Œë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. ì£¼ë¡œ ì¶œë ¥ìš©ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.
    - **ê²°ê³¼ ëª¨ìœ¼ê¸°**
        - collect(Collector): List,Set,Map ë“±ì˜ collectionìœ¼ë¡œ ë³€í™˜í•œë‹¤. ì¦‰, ë°ì´í„°ë¥¼ collectionì— ëª¨ì„ ë•Œ ì‚¬ìš©í•œë‹¤.
        - toArray(): ë°°ì—´ë¡œ ë³€í™˜í•œë‹¤.
    - **í†µê³„ ë° ê³„ì‚°**
        - count(): ìš”ì†Œì˜ ê°œìˆ˜ë¥¼ ì„¼ë‹¤. longíƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
        - max(), min(): ìµœëŒ“ê°’/ìµœì†Ÿê°’ì„ ë°˜í™˜í•œë‹¤. Optionalë¡œ ë°˜í™˜í•œë‹¤.
    - **ì¡°ê±´ ê²€ì‚¬**
        - anyMatch(Predicate): í•˜ë‚˜ë¼ë„ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ trueë¥¼ ë°˜í™˜í•œë‹¤.
        - allMatch(Predicate): ëª¨ë‘ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ trueë¥¼ ë°˜í™˜í•œë‹¤.
        - noneMatch(Predicate): ëª¨ë‘ ì¡°ê±´ì„ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë©´ trueë¥¼ ë°˜í™˜í•œë‹¤.
    - **ê²€ìƒ‰**
        - findFirst(): ì²« ë²ˆì§¸ ìš”ì†Œë¥¼ ë°˜í™˜í•œë‹¤.
        - findAny(): ì•„ë¬´ê±°ë‚˜ í•˜ë‚˜ ë°˜í™˜í•œë‹¤ (ë³‘ë ¬ ì²˜ë¦¬ì—ì„œ findFirstë³´ë‹¤ ë¹ ë¥´ë‹¤).

### 2ë²ˆ ì‹¤ìˆ˜: ë°ì´í„° êµ¬ì¡°ë¥¼ ë°”ê¿€ ë•Œ ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ë„ ìˆë‹¤.
> ê¸°ì¡´ì˜ ì›ë³¸ ë°ì´í„°ì—ì„œ ë°ì´í„° êµ¬ì¡°ë¥¼ ë°”ê¾¸ë ¤ê³  í•˜ë©´ ConcurrentModificationException(ë™ì‹œ ìˆ˜ì • ì˜ˆì™¸) ë°œìƒ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤.

<br>

**í•´ê²°ì±…**

> ì›ë³¸ì˜ ë°ì´í„° êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ì§€ ë§ê³  ì¡°ê±´ì— ë§ëŠ” ìƒˆë¡œìš´ collectionì„ ìƒì„±í•´ì•¼ í•œë‹¤. (ë§ˆì§€ë§‰ì— .collect(Collectors.toList())ë¥¼ ì‚¬ìš©)

### 3ë²ˆ ì‹¤ìˆ˜: ë³‘ë ¬ì²˜ë¦¬ì˜ overhead
ë³‘ë ¬ì²˜ë¦¬ê°€ í•­ìƒ 
### 4ë²ˆ ì‹¤ìˆ˜: Terminal Operation ë¯¸ì‚¬ìš©
### 5ë²ˆ ì‹¤ìˆ˜: Terminal Operation ë¯¸ì‚¬ìš©
### 6ë²ˆ ì‹¤ìˆ˜: Terminal Operation ë¯¸ì‚¬ìš©
### 7ë²ˆ ì‹¤ìˆ˜: Terminal Operation ë¯¸ì‚¬ìš©

## ì‹¤ì œ êµ¬í˜„
ì‹¤í–‰ ì†ë„ì— ì˜í–¥ì„ ì£¼ëŠ” 3,4ë²ˆ ì‹¤ìˆ˜ë¥¼ êµ¬í˜„ í•´ ë³¼ ê²ƒì´ë‹¤.

### 1. í° ë°ì´í„°ì™€ ì‘ì€ ë°ì´í„°ì—ì„œ ìˆœì°¨ì²˜ë¦¬ì™€ ë³‘ë ¬ì²˜ë¦¬ì˜ ì‹¤í–‰ ì†ë„ ë¹„êµ(StreamLab.java)
1. **ë°ì´í„° í¬ê¸°**: ì‘ì€ ë°ì´í„°: 1,000ê°œ, í° ë°ì´í„°: 10,000,000ê°œ
2. **ì—°ì‚° ì‘ì—…**: ë¦¬ìŠ¤íŠ¸ì˜ ê° ìˆ«ìë¥¼ ì œê³±í•˜ì—¬ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ì— ë„£ê¸°

### êµ¬í˜„ ì½”ë“œ
```
package streamlab;

import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.IntStream;


// 3ë²ˆ ì˜ˆì‹œ
public class StreamLab {

    public static void main(String[] args) {
        // 1. ë°ì´í„° ì¤€ë¹„
        System.out.println("ë°ì´í„° ìƒì„± ì¤‘");
        // ì‘ì€ ë°ì´í„° (1,000ê°œ)
        List<Integer> smallData = IntStream.rangeClosed(1, 1_000).boxed().collect(Collectors.toList());
        // í° ë°ì´í„° (1,000ë§Œ ê°œ)
        List<Integer> largeData = IntStream.rangeClosed(1, 10_000_000).boxed().collect(Collectors.toList());
        System.out.println("ë°ì´í„° ì¤€ë¹„ ì™„ë£Œ.\n");

        // ----------------------------------------------------

        System.out.println("=== 1. ì‘ì€ ë°ì´í„°ì…‹ (1,000ê°œ) ===");
        runTest("Small - Sequential", smallData, false);
        runTest("Small - Parallel  ", smallData, true);

        System.out.println("\n----------------------------------------------------\n");

        System.out.println("=== 2. í° ë°ì´í„°ì…‹ (1,000ë§Œ ê°œ) ===");
        
        runTest("Large - Sequential", largeData, false);
      
        runTest("Large - Parallel  ", largeData, true);
    }

    public static void runTest(String name, List<Integer> data, boolean isParallel) {
        long startTime = System.currentTimeMillis();

        List<Integer> result;
        if (isParallel) {
            result = data.parallelStream()
                .map(n -> {
                    return n * n;
                })
                .collect(Collectors.toList());
        } else {
            result = data.stream()
                .map(n -> {
                    return n * n;
                })
                .collect(Collectors.toList());
        }

        long endTime = System.currentTimeMillis();
        System.out.println(name + " : " + (endTime - startTime) + " ms");
    }
}
```
### ê²°ê³¼ ë¶„ì„ (Result)

| ë°ì´í„° í¬ê¸° | ì²˜ë¦¬ ë°©ì‹ (Method) | ì†Œìš” ì‹œê°„ (ì¸¡ì •ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë‚˜ì˜´) |
|:---:|:---:|:---|
| **ì‘ì€ ë°ì´í„°** | **Stream (Sequential)** | 1ms |
|  | **Stream (Parallel)** | 12ms | 
| **í° ë°ì´í„°** | **Stream (Sequential)** | 445ms | 
| | **Stream (Parallel)** | 336ms |
- í° ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œì—ëŠ” ë³‘ë ¬ì²˜ë¦¬ ë°©ì‹ì´ ë” ë¹ ë¥´ì§€ë§Œ ì‘ì€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œì—ëŠ” ìˆœì°¨ì²˜ë¦¬ ë°©ì‹ì´ ë” ë¹ ë¥´ë‹¤.

<br>

**ì‘ì€ ë°ì´í„°ì—ì„œ ë³‘ë ¬ì²˜ë¦¬ê°€ ëŠë¦° ì´ìœ **
  > ë³‘ë ¬ì²˜ë¦¬ë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒˆë¡œìš´ ìŠ¤ë ˆë“œë¥¼ í• ë‹¹í•˜ê³ , CPUê°€ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì™”ë‹¤ ê°”ë‹¤ í•˜ëŠ” context switching ë¹„ìš©ì´ ë°œìƒí•œë‹¤. ë°ì´í„°ê°€ ì‘ì€ ê²½ìš° ë°ì´í„°ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë¹„ìš©ë³´ë‹¤ context switchí•˜ëŠ” ë¹„ìš©ì´ ë” í¬ê¸° ë•Œë¬¸ì— ëŠë¦¬ê²Œ ë‚˜ì˜¨ë‹¤

### 2. filter()ë‚˜ map() ê°™ì€ ì¤‘ê°„ ì—°ì‚°ìë“¤ì„ ë§ì´ ì‚¬ìš©í–ˆì„ ë•Œì˜ ì„±ëŠ¥ ë¹„êµ (StreamLab2.java)

### ê²°ê³¼ ë¶„ì„ (Result)

| ì²˜ë¦¬ ë°©ì‹ (Method) | ì†Œìš” ì‹œê°„ (ì¸¡ì •ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë‚˜ì˜´) |
|:---:|:---|
| **ì¤‘ê°„ ì—°ì‚°ìê°€ ë§ì„ ë•Œ** | 5ms |
| **ì¤‘ê°„ ì—°ì‚°ìê°€ ì ì„ ë•Œ**  | 2ms |
- ì¤‘ê°„ ì—°ì‚°ìê°€ ì ì„ ë•Œ ë” ë¹¨ëë‹¤.

<br>

**ì¤‘ê°„ ì—°ì‚°ìê°€ ë§ì„ ë•Œ ë” ëŠë¦° ì´ìœ **
  1. ì—°ì‚°ìë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ ê°ì²´ê°€ í™ ë©”ëª¨ë¦¬ì— ê³„ì† ë§Œë“¤ì–´ì§„ë‹¤. ê°ì²´ë¥¼ ìƒì„±í•˜ë©° ë“œëŠ” ë¹„ìš©ìœ¼ë¡œ ì¸í•´ ì†ë„ê°€ ëŠë ¤ì§„ë‹¤.
  2. ì—°ì‚°ìê°€ ë‚˜ë‰˜ì–´ ìˆìœ¼ë©´ ë°ì´í„°ê°€ ì§€ë‚˜ê°ˆ ë•Œë§ˆë‹¤ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼í•œë‹¤. ì¦‰, í•¨ìˆ˜ í˜¸ì¶œ ë¹„ìš©ì´ ë“ ë‹¤.
